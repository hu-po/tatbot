{
  "uid": "tatbot-compute",
  "title": "Tatbot Compute",
  "timezone": "browser",
  "schemaVersion": 39,
  "version": 1,
  "refresh": "5s",
  "time": {
    "from": "now-5m",
    "to": "now"
  },
  "templating": {
    "list": [
      {
        "type": "query",
        "name": "instance",
        "label": "Instance",
        "datasource": "Prometheus",
        "query": "label_values(up, instance)",
        "refresh": 2,
        "multi": true,
        "includeAll": true
      }
    ]
  },
  "panels": [
    {
      "type": "timeseries",
      "title": "CPU Utilization (%) by Instance",
      "gridPos": {"x": 8, "y": 0, "w": 8, "h": 8},
      "fieldConfig": {
        "defaults": {},
        "overrides": [
          { "matcher": { "id": "byName", "options": "ü¶¶ eek" }, "properties": [ { "id": "color", "value": { "mode": "fixed", "fixedColor": "#7EB26D" } } ] },
          { "matcher": { "id": "byName", "options": "ü¶î hog" }, "properties": [ { "id": "color", "value": { "mode": "fixed", "fixedColor": "#EAB839" } } ] },
          { "matcher": { "id": "byName", "options": "ü¶ß ook" }, "properties": [ { "id": "color", "value": { "mode": "fixed", "fixedColor": "#6ED0E0" } } ] },
          { "matcher": { "id": "byName", "options": "ü¶ä oop" }, "properties": [ { "id": "color", "value": { "mode": "fixed", "fixedColor": "#EF843C" } } ] },
          { "matcher": { "id": "byName", "options": "ü¶é ojo" }, "properties": [ { "id": "color", "value": { "mode": "fixed", "fixedColor": "#705DA0" } } ] },
          { "matcher": { "id": "byName", "options": "üçì rpi1" }, "properties": [ { "id": "color", "value": { "mode": "fixed", "fixedColor": "#1F78C1" } } ] },
          { "matcher": { "id": "byName", "options": "üçá rpi2" }, "properties": [ { "id": "color", "value": { "mode": "fixed", "fixedColor": "#E24D42" } } ] }
        ]
      },
      "targets": [
        {
          "datasource": "Prometheus",
          "expr": "100 - (avg by (instance)(irate(node_cpu_seconds_total{mode=\"idle\",instance=~\"$instance\"}[5m])) * 100)",
          "legendFormat": "{{instance}}"
        },
        {
          "datasource": "Prometheus",
          "expr": "avg by (instance)(cpu_Hz{statistic=\"val\",instance=~\"$instance\"}) / avg by (instance)(cpu_Hz{statistic=\"max_freq\",instance=~\"$instance\"}) * 100",
          "legendFormat": "{{instance}}"
        }
      ]
    },
    {
      "type": "timeseries",
      "title": "Memory Utilization (%) by Instance",
      "gridPos": {"x": 16, "y": 0, "w": 8, "h": 8},
      "fieldConfig": {
        "defaults": {},
        "overrides": [
          { "matcher": { "id": "byName", "options": "ü¶¶ eek" }, "properties": [ { "id": "color", "value": { "mode": "fixed", "fixedColor": "#7EB26D" } } ] },
          { "matcher": { "id": "byName", "options": "ü¶î hog" }, "properties": [ { "id": "color", "value": { "mode": "fixed", "fixedColor": "#EAB839" } } ] },
          { "matcher": { "id": "byName", "options": "ü¶ß ook" }, "properties": [ { "id": "color", "value": { "mode": "fixed", "fixedColor": "#6ED0E0" } } ] },
          { "matcher": { "id": "byName", "options": "ü¶ä oop" }, "properties": [ { "id": "color", "value": { "mode": "fixed", "fixedColor": "#EF843C" } } ] },
          { "matcher": { "id": "byName", "options": "ü¶é ojo" }, "properties": [ { "id": "color", "value": { "mode": "fixed", "fixedColor": "#705DA0" } } ] },
          { "matcher": { "id": "byName", "options": "üçì rpi1" }, "properties": [ { "id": "color", "value": { "mode": "fixed", "fixedColor": "#1F78C1" } } ] },
          { "matcher": { "id": "byName", "options": "üçá rpi2" }, "properties": [ { "id": "color", "value": { "mode": "fixed", "fixedColor": "#E24D42" } } ] }
        ]
      },
      "targets": [
        {
          "datasource": "Prometheus",
          "expr": "(1 - (avg by (instance)(node_memory_MemAvailable_bytes{instance=~\"$instance\"}) / avg by (instance)(node_memory_MemTotal_bytes{instance=~\"$instance\"}))) * 100",
          "legendFormat": "{{instance}}"
        },
        {
          "datasource": "Prometheus",
          "expr": "avg by (instance)(ram_kB{statistic=\"used\",instance=~\"$instance\"}) / avg by (instance)(ram_kB{statistic=\"total\",instance=~\"$instance\"}) * 100",
          "legendFormat": "{{instance}}"
        }
      ]
    },
    {
      "type": "timeseries",
      "title": "NVIDIA GPU Utilization (%) by Instance",
      "description": "Shows GPU utilization for discrete GPUs. Jetson integrated GPUs show frequency scaling instead of utilization.",
      "gridPos": {"x": 0, "y": 0, "w": 8, "h": 8},
      "fieldConfig": {
        "defaults": {},
        "overrides": [
          { "matcher": { "id": "byName", "options": "ü¶¶ eek" }, "properties": [ { "id": "color", "value": { "mode": "fixed", "fixedColor": "#7EB26D" } } ] },
          { "matcher": { "id": "byName", "options": "ü¶î hog" }, "properties": [ { "id": "color", "value": { "mode": "fixed", "fixedColor": "#EAB839" } } ] },
          { "matcher": { "id": "byName", "options": "ü¶ß ook" }, "properties": [ { "id": "color", "value": { "mode": "fixed", "fixedColor": "#6ED0E0" } } ] },
          { "matcher": { "id": "byName", "options": "ü¶ä oop" }, "properties": [ { "id": "color", "value": { "mode": "fixed", "fixedColor": "#EF843C" } } ] },
          { "matcher": { "id": "byName", "options": "ü¶é ojo" }, "properties": [ { "id": "color", "value": { "mode": "fixed", "fixedColor": "#705DA0" } } ] },
          { "matcher": { "id": "byName", "options": "üçì rpi1" }, "properties": [ { "id": "color", "value": { "mode": "fixed", "fixedColor": "#1F78C1" } } ] },
          { "matcher": { "id": "byName", "options": "üçá rpi2" }, "properties": [ { "id": "color", "value": { "mode": "fixed", "fixedColor": "#E24D42" } } ] }
        ]
      },
      "targets": [
        {
          "datasource": "Prometheus",
          "expr": "avg by (instance) (DCGM_FI_DEV_GPU_UTIL{instance=~\"$instance\"})",
          "legendFormat": "{{instance}}"
        }
      ]
    },
    {
      "type": "timeseries",
      "title": "Network Throughput (MB/s) by Instance",
      "gridPos": {"x": 0, "y": 8, "w": 8, "h": 8},
      "fieldConfig": {
        "defaults": {},
        "overrides": [
          { "matcher": { "id": "byName", "options": "ü¶¶ eek" }, "properties": [ { "id": "color", "value": { "mode": "fixed", "fixedColor": "#7EB26D" } } ] },
          { "matcher": { "id": "byName", "options": "ü¶î hog" }, "properties": [ { "id": "color", "value": { "mode": "fixed", "fixedColor": "#EAB839" } } ] },
          { "matcher": { "id": "byName", "options": "ü¶ß ook" }, "properties": [ { "id": "color", "value": { "mode": "fixed", "fixedColor": "#6ED0E0" } } ] },
          { "matcher": { "id": "byName", "options": "ü¶ä oop" }, "properties": [ { "id": "color", "value": { "mode": "fixed", "fixedColor": "#EF843C" } } ] },
          { "matcher": { "id": "byName", "options": "ü¶é ojo" }, "properties": [ { "id": "color", "value": { "mode": "fixed", "fixedColor": "#705DA0" } } ] },
          { "matcher": { "id": "byName", "options": "üçì rpi1" }, "properties": [ { "id": "color", "value": { "mode": "fixed", "fixedColor": "#1F78C1" } } ] },
          { "matcher": { "id": "byName", "options": "üçá rpi2" }, "properties": [ { "id": "color", "value": { "mode": "fixed", "fixedColor": "#E24D42" } } ] }
        ]
      },
      "targets": [
        {
          "datasource": "Prometheus",
          "expr": "(sum by (instance) (rate(node_network_receive_bytes_total{device!~\"lo\", instance=~\"$instance\"}[5m]) + rate(node_network_transmit_bytes_total{device!~\"lo\", instance=~\"$instance\"}[5m])))/1048576",
          "legendFormat": "{{instance}}"
        }
      ]
    },
    {
      "type": "timeseries",
      "title": "Intel GPU Busy (%) by Instance",
      "gridPos": {"x": 16, "y": 8, "w": 8, "h": 8},
      "fieldConfig": {
        "defaults": {},
        "overrides": [
          { "matcher": { "id": "byName", "options": "ü¶¶ eek" }, "properties": [ { "id": "color", "value": { "mode": "fixed", "fixedColor": "#7EB26D" } } ] },
          { "matcher": { "id": "byName", "options": "ü¶î hog" }, "properties": [ { "id": "color", "value": { "mode": "fixed", "fixedColor": "#EAB839" } } ] },
          { "matcher": { "id": "byName", "options": "ü¶ß ook" }, "properties": [ { "id": "color", "value": { "mode": "fixed", "fixedColor": "#6ED0E0" } } ] },
          { "matcher": { "id": "byName", "options": "ü¶ä oop" }, "properties": [ { "id": "color", "value": { "mode": "fixed", "fixedColor": "#EF843C" } } ] },
          { "matcher": { "id": "byName", "options": "ü¶é ojo" }, "properties": [ { "id": "color", "value": { "mode": "fixed", "fixedColor": "#705DA0" } } ] },
          { "matcher": { "id": "byName", "options": "üçì rpi1" }, "properties": [ { "id": "color", "value": { "mode": "fixed", "fixedColor": "#1F78C1" } } ] },
          { "matcher": { "id": "byName", "options": "üçá rpi2" }, "properties": [ { "id": "color", "value": { "mode": "fixed", "fixedColor": "#E24D42" } } ] }
        ]
      },
      "targets": [
        {
          "datasource": "Prometheus",
          "expr": "avg by (instance) (igpu_engines_render_3d_0_busy{instance=~\"$instance\"})",
          "legendFormat": "{{instance}}"
        }
      ]
    },
    {
      "type": "timeseries",
      "title": "Disk Utilization (%) by Instance",
      "gridPos": {"x": 8, "y": 8, "w": 8, "h": 8},
      "fieldConfig": {
        "defaults": {},
        "overrides": [
          {
            "matcher": { "id": "byName", "options": "REPLACE_ME_NODE_1:9100" },
            "properties": [ { "id": "color", "value": { "mode": "fixed", "fixedColor": "red" } } ]
          },
          {
            "matcher": { "id": "byName", "options": "REPLACE_ME_NODE_2:9100" },
            "properties": [ { "id": "color", "value": { "mode": "fixed", "fixedColor": "blue" } } ]
          },
          {
            "matcher": { "id": "byName", "options": "REPLACE_ME_NODE_3:9100" },
            "properties": [ { "id": "color", "value": { "mode": "fixed", "fixedColor": "green" } } ]
          }
        ]
      },
      "targets": [
        {
          "datasource": "Prometheus",
          "expr": "100 - (avg by (instance) (node_filesystem_avail_bytes{fstype!~\"tmpfs|overlay|squashfs|aufs|ramfs\", mountpoint!~\"/(run|boot|var/lib/docker|var/lib/containers|snap).*\", instance=~\"$instance\"} / node_filesystem_size_bytes{fstype!~\"tmpfs|overlay|squashfs|aufs|ramfs\", mountpoint!~\"/(run|boot|var/lib/docker|var/lib/containers|snap).*\", instance=~\"$instance\"})) * 100",
          "legendFormat": "{{instance}}"
        },
        {
          "datasource": "Prometheus",
          "expr": "avg by (instance)(disk_GB{mountpoint=\"used\",instance=~\"$instance\"}) / avg by (instance)(disk_GB{mountpoint=\"total\",instance=~\"$instance\"}) * 100",
          "legendFormat": "{{instance}}"
        }
      ]
    }
  ]
}
